<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Something Pretty</title>
  <!-- Load jQuery from CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.js"></script>
  <!-- Load SheetJS from CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/jszip.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/xlsx.js"></script>
  <style>
  </style>
</header>
<body>
<input type="file" id="db" />
<textarea id="APIJSON" rows=12 cols=100 onInput="parseJSONs(this.value);" tabindex="1" onFocus="this.select()"></textarea>
<div id="err"></div>
<script language="javascript">
  //https://stackoverflow.com/questions/8238407/how-to-parse-excel-xls-file-in-javascript-html5
  //https://redstapler.co/sheetjs-tutorial-convert-excel-html-table/
  $('#db').change(function(e) {
    var reader = new FileReader();
    reader.readAsArrayBuffer(e.target.files[0]);
    reader.onload = function(e){
      var data = new Uint8Array(reader.result);
      var workbook = XLSX.read(data,{type:'array'});
      // Store in global variable
      // Alternative, retrieve the output JSON from the field?
      // Plot only occurs when the data is loaded anyways.
      var parts = XLSX.utils.sheet_to_json(workbook.Sheets["Sheet1"]);
      if( document.getElementById("JSON") ){
        parts.forEach((p,i) => {
        });
      }
    }
  });
</script>

<script language="javascript">
</script>

</body>
</html>
